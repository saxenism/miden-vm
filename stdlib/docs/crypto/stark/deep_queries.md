
## std::crypto::stark::deep_queries
| Procedure | Description |
| ----------- | ------------- |
| combine_main | Computes a single step of the random linear combination defining the DEEP composition polynomial<br /><br />that is the input to the FRI protocol. More precisely, the sum in question is:<br /><br />$$<br /><br />\sum_{i=0}^k{\alpha_i \cdot \left(\frac{T_i(x) - T_i(z)}{x - z} +<br /><br />\frac{T_i(x) - T_i(z \cdot g)}{x - z \cdot g} \right)}<br /><br />$$<br /><br />and the following instruction computes the denominators $\alpha_i \cdot (T_i(x) - T_i(z))$ and<br /><br />$\alpha_i \cdot (T_i(x) - T_i(z \cdot g))$ and stores the values in two accumulators $r$ and $p$,<br /><br />respectively. This instruction is specialized to main trace columns i.e. the values $T_i(x)$ are<br /><br />base field elements.<br /><br />The stack transition of the instruction can be visualized as follows:<br /><br />+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+---+<br /><br />\|  T7  \|  T6  \|  T5  \|  T4  \|  T3  \|  T2  \|  T1  \|  T0  \|  p1  \|  p0  \|  r1  \|  r0  \|x_addr\|z_addr\|a_addr\| - \|<br /><br />+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+---+<br /><br />\|\|<br /><br />\/<br /><br />+------+------+------+------+------+------+------+------+------+------+------+------+------+--------+--------+---+<br /><br />\|  T0  \|  T7  \|  T6  \|  T5  \|  T4  \|  T3  \|  T2  \|  T1  \|  p1' \|  p0' \|  r1' \|  r0' \|x_addr\|z_addr+1\|a_addr+1\| - \|<br /><br />+------+------+------+------+------+------+------+------+------+------+------+------+------+--------+--------+---+<br /><br />Here:<br /><br />1- Ti for i in 0..=7 stands for the the value of the i-th trace polynomial for the current query i.e. T_i(x).<br /><br />2- (p0, p1) stands for an extension field element accumulating the values for the quotients with common denominator (x - gz).<br /><br />3- (r0, r1) stands for an extension field element accumulating the values for the quotients with common denominator (x - z).<br /><br />4- x_addr is the memory address from which we are loading the Ti's using the MSTREAM instruction.<br /><br />5- z_addr is the memory address to the i-th OOD evaluation frame at z and gz i.e. T_i(z):= (T_i(z)0, T_i(z)1)<br /><br />and T_i(gz):= (T_i(gz)0, T_i(gz)1)<br /><br />6- a_addr is the memory address of the i-th random element used in batching the trace polynomial quotients.<br /><br />The random elements a := (a0, a1) are stored in memory as [0, 0, a0, a1].<br /><br />Input: [T7, T6, T5, T4, T3, T2, T1, T0, p1, p0, r1, r0, x_addr, z_addr, a_addr, 0]<br /><br />Output: [T0, T7, T6, T5, T4, T3, T2, T1, p1', p0', r1', r0', x_addr, z_addr+1, a_addr+1, 0] |
| combine_aux | Computes a single step of the random linear combination defining the DEEP composition polynomial<br /><br />that is the input to the FRI protocol. More precisely, the sum in question is:<br /><br />$$<br /><br />\sum_{i=0}^k{\alpha_i \cdot \left(\frac{T_i(x) - T_i(z)}{x - z} +<br /><br />\frac{T_i(x) - T_i(z \cdot g)}{x - z \cdot g} \right)}<br /><br />$$<br /><br />and the following instruction computes the denominators $\alpha_i \cdot (T_i(x) - T_i(z))$ and<br /><br />$\alpha_i \cdot (T_i(x) - T_i(z \cdot g))$ and stores the values in two accumulators $r$ and $p$,<br /><br />respectively. This instruction is specialized to auxiliary trace columns i.e. the values $T_i(x)$<br /><br />are field elements in a quadratic extension field.<br /><br />The stack transition of the instruction can be visualized as follows:<br /><br />+-------+-------+-------+-------+-------+-------+-------+-------+------+------+------+------+------+------+------+---+<br /><br />\|  T31  \|  T30  \|  T21  \|  T20  \|  T11  \|  T10  \|  T01  \|  T00  \|  p1  \|  p0  \|  r1  \|  r0  \|x_addr\|z_addr\|a_addr\| - \|<br /><br />+-------+-------+-------+-------+-------+-------+-------+-------+------+------+------+------+------+------+------+---+<br /><br />\|\|<br /><br />\/<br /><br />+-------+-------+-------+-------+-------+-------+-------+-------+------+------+------+------+------+--------+--------+-----+<br /><br />\|  T31  \|  T30  \|  T21  \|  T20  \|  T11  \|  T10  \|  T01  \|  T00  \|  p1' \|  p0' \|  r1' \|  r0' \|x_addr\|z_addr+1\|a_addr+b\|  -  \|<br /><br />+-------+-------+-------+-------+-------+-------+-------+-------+------+------+------+------+------+--------+--------------+<br /><br />Here:<br /><br />1- Tij for i in 0..=3 and j=0,1 stands for the the value of the j-th coordinate in the quadratic extension field<br /><br />of the i-th auxiliary trace polynomial for the current query i.e. $T_i(x)$.<br /><br />2- (p0, p1) stands for an extension field element accumulating the values for the quotients with common denominator (x - gz).<br /><br />3- (r0, r1) stands for an extension field element accumulating the values for the quotients with common denominator (x - z).<br /><br />4- x_addr is the memory address from which we are loading the Ti's using the MSTREAM instruction.<br /><br />5- z_addr is the memory address to the i-th OOD evaluation frame at z and gz i.e. T_i(z):= (T_i(z)0, T_i(z)1) and T_i(gz):= (T_i(gz)0, T_i(gz)1)<br /><br />6- a_addr is the memory address of the i-th random element used in batching the trace polynomial quotients.<br /><br />The random elements a := (a0, a1) are stored in memory as [0, 0, a0, a1].<br /><br />Input: [T31, T30, T21, T20, T11, T10, T01, T00, p1, p0, r1, r0, x_addr, z_addr, a_addr, 0]<br /><br />Output: [T01, T00, T31, T30, T21, T20, T11, T10, p1', p0', r1', r0', x_addr, z_addr', a_addr', 0] |
| compute_deep_composition_polynomial_queries | Compute the DEEP composition polynomial FRI queries.<br /><br />Input: [query_ptr, ...]<br /><br />Output: [...]<br /><br />Cycles: 6 + num_queries * 463 |
